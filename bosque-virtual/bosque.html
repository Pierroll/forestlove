<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bosque Virtual – El Bosque</title>
    <meta name="description" content="Mapa del bosque de nuestros recuerdos compartidos." />
    <link rel="stylesheet" href="css/styles.css" />
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web@2.1.1/src/index.js"></script>
    <style>
        body.bosque-page {
            background: var(--beige-claro);
            padding-top: 60px;
            min-height: 100vh;
        }

        /* ── Mapa ── */
        .mapa-wrapper {
            max-width: 1100px;
            margin: 28px auto 0;
            padding: 0 20px;
        }

        .mapa-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 14px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .mapa-titulo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.7rem;
            font-weight: 500;
            color: var(--verde-oscuro);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mapa-titulo i {
            font-size: 1.4rem;
            color: var(--verde-claro);
        }

        .mapa-badge {
            font-size: 0.78rem;
            color: var(--texto-suave);
            background: white;
            border: 1px solid var(--beige-oscuro);
            padding: 4px 12px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .mapa-badge i {
            color: var(--verde-claro);
        }

        #mapa {
            position: relative;
            width: 100%;
            padding-bottom: 58%;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(27, 67, 50, 0.2);
            background: #1a3a28;
        }

        #mapa-bg {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.88;
        }

        #mapa-arboles {
            position: absolute;
            inset: 0;
        }

        #mapa::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse at center, transparent 45%, rgba(8, 22, 14, 0.35) 100%);
            pointer-events: none;
            z-index: 5;
        }

        /* ── Leyenda ── */
        .leyenda {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 12px;
            padding: 10px 16px;
            background: white;
            border-radius: 10px;
            border: 1px solid var(--beige-oscuro);
        }

        .leyenda-item {
            display: flex;
            align-items: center;
            gap: 7px;
            font-size: 0.78rem;
            color: var(--texto-suave);
        }

        .leyenda-dot {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .leyenda-dot i {
            font-size: 0.75rem;
        }

        .leyenda-dot.brote {
            background: #e8f8ee;
            color: #2d6a4f;
            border: 1.5px solid #95D5B2;
        }

        .leyenda-dot.joven {
            background: #c8eedd;
            color: #1b4332;
            border: 1.5px solid #74C69D;
        }

        .leyenda-dot.grande {
            background: #2D6A4F;
            color: #D8F3DC;
            border: 1.5px solid #1B4332;
        }

        .leyenda-dot.especial {
            background: #fdf3d7;
            color: #8a6a00;
            border: 1.5px solid #C9A84C;
        }

        /* ── Layout ── */
        .bosque-layout {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 24px;
            max-width: 1100px;
            margin: 0 auto;
            padding: 20px 20px 48px;
        }

        @media (max-width: 900px) {
            .bosque-layout {
                grid-template-columns: 1fr;
            }
        }

        /* ── Panel lateral ── */
        .panel-lateral {
            background: white;
            border-radius: 16px;
            padding: 24px;
            border: 1px solid rgba(116, 198, 157, 0.15);
            box-shadow: 0 2px 12px var(--sombra);
            height: fit-content;
            position: sticky;
            top: 80px;
        }

        .panel-titulo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--verde-oscuro);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-titulo i {
            color: var(--verde-claro);
            font-size: 1.1rem;
        }

        /* Selector de tipo */
        .tipo-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
            margin-top: 6px;
        }

        .tipo-option {
            display: flex;
            align-items: center;
            gap: 7px;
            padding: 9px 11px;
            border: 1.5px solid #e0ede5;
            border-radius: 9px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.82rem;
            color: var(--texto-medio);
        }

        .tipo-option:has(input:checked) {
            border-color: var(--verde-claro);
            background: #f0faf4;
            color: var(--verde-oscuro);
        }

        .tipo-option input {
            display: none;
        }

        .tipo-option i {
            font-size: 1rem;
        }

        /* Posición preview */
        .pos-preview {
            background: var(--beige-claro);
            border: 1px solid var(--beige-oscuro);
            border-radius: 8px;
            padding: 10px 12px;
            margin-bottom: 16px;
            font-size: 0.8rem;
            color: var(--texto-suave);
            text-align: center;
        }

        .pos-preview strong {
            color: var(--verde-oscuro);
        }

        /* ── Modal ── */
        .modal-header-tipo {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            margin-bottom: 20px;
        }

        .modal-arbol-icon {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .modal-arbol-icon i {
            font-size: 1.6rem;
        }

        .modal-arbol-icon.brote {
            background: #e8f8ee;
            color: #2d6a4f;
            border: 2px solid #95D5B2;
        }

        .modal-arbol-icon.joven {
            background: #c8eedd;
            color: #1b4332;
            border: 2px solid #74C69D;
        }

        .modal-arbol-icon.grande {
            background: #2D6A4F;
            color: #D8F3DC;
            border: 2px solid #1B4332;
        }

        .modal-arbol-icon.especial {
            background: #fdf3d7;
            color: #8a6a00;
            border: 2px solid #C9A84C;
        }
    </style>
</head>

<body class="bosque-page">

    <!-- Navbar -->
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">
            <i class="ph ph-tree-evergreen"></i>
            Bosque Virtual
        </a>
        <ul class="navbar-nav">
            <li><a href="index.html"><i class="ph ph-house"></i> <span>Inicio</span></a></li>
            <li><a href="bosque.html" class="active"><i class="ph ph-map-trifold"></i> <span>Bosque</span></a></li>
            <li><a href="dashboard.html"><i class="ph ph-chart-bar"></i> <span>Dashboard</span></a></li>
            <li><a href="#" onclick="cerrarSesion()"><i class="ph ph-sign-out"></i> <span>Salir</span></a></li>
        </ul>
    </nav>

    <!-- Mapa -->
    <div class="mapa-wrapper">
        <div class="mapa-header">
            <h1 class="mapa-titulo">
                <i class="ph ph-map-trifold"></i>
                Nuestro Bosque
            </h1>
            <div class="mapa-badge">
                <i class="ph ph-tree"></i>
                <span id="contador-arboles">0</span> recuerdos plantados
            </div>
        </div>

        <div id="mapa">
            <img id="mapa-bg" src="assets/bosque-bg.jpg" alt="Bosque ilustrado de nuestros recuerdos" />
            <div id="mapa-arboles"></div>
        </div>

        <!-- Leyenda -->
        <div class="leyenda">
            <div class="leyenda-item">
                <div class="leyenda-dot brote"><i class="ph ph-plant"></i></div>
                Brote – nuevo recuerdo
            </div>
            <div class="leyenda-item">
                <div class="leyenda-dot joven"><i class="ph ph-leaf"></i></div>
                Joven – recuerdo especial
            </div>
            <div class="leyenda-item">
                <div class="leyenda-dot grande"><i class="ph ph-tree"></i></div>
                Grande – recuerdo profundo
            </div>
            <div class="leyenda-item">
                <div class="leyenda-dot especial"><i class="ph ph-star"></i></div>
                Especial – momento único
            </div>
        </div>
    </div>

    <!-- Layout -->
    <div class="bosque-layout">
        <div></div>

        <!-- Panel: agregar recuerdo -->
        <div class="panel-lateral">
            <h2 class="panel-titulo">
                <i class="ph ph-plus-circle"></i>
                Plantar un Recuerdo
            </h2>

            <form id="form-recuerdo">
                <div class="form-group">
                    <label for="r-titulo">Título del recuerdo</label>
                    <input type="text" id="r-titulo" placeholder="¿Cómo lo llamamos?" required />
                </div>

                <div class="form-group">
                    <label for="r-fecha">Fecha</label>
                    <input type="date" id="r-fecha" required />
                </div>

                <div class="form-group">
                    <label for="r-lugar">Lugar</label>
                    <input type="text" id="r-lugar" placeholder="¿Dónde fue?" required />
                </div>

                <div class="form-group">
                    <label for="r-historia">Historia</label>
                    <textarea id="r-historia" placeholder="Cuéntame qué pasó ese día..." required></textarea>
                </div>

                <div class="form-group">
                    <label>Tipo de árbol</label>
                    <div class="tipo-selector">
                        <label class="tipo-option">
                            <input type="radio" name="r-tipo" value="brote" checked />
                            <i class="ph ph-plant"></i> Brote
                        </label>
                        <label class="tipo-option">
                            <input type="radio" name="r-tipo" value="joven" />
                            <i class="ph ph-leaf"></i> Joven
                        </label>
                        <label class="tipo-option">
                            <input type="radio" name="r-tipo" value="grande" />
                            <i class="ph ph-tree"></i> Grande
                        </label>
                        <label class="tipo-option">
                            <input type="radio" name="r-tipo" value="especial" />
                            <i class="ph ph-star"></i> Especial
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Posición horizontal: <span class="slider-value" id="val-x">50%</span></label>
                    <input type="range" id="r-x" min="5" max="95" value="50"
                        oninput="document.getElementById('val-x').textContent = this.value + '%'; previsualizarPosicion()" />
                </div>

                <div class="form-group">
                    <label>Posición vertical: <span class="slider-value" id="val-y">50%</span></label>
                    <input type="range" id="r-y" min="5" max="95" value="50"
                        oninput="document.getElementById('val-y').textContent = this.value + '%'; previsualizarPosicion()" />
                </div>

                <div class="pos-preview" id="pos-preview">
                    El árbol se plantará en: <strong>centro del bosque</strong>
                </div>

                <button type="submit" class="btn-bosque" style="width:100%; justify-content:center;">
                    <i class="ph ph-tree"></i>
                    Plantar Recuerdo
                </button>
            </form>
        </div>
    </div>

    <!-- Modal de recuerdo -->
    <div class="modal-overlay" id="modal-overlay" role="dialog" aria-modal="true">
        <div class="modal-box">
            <button class="modal-close" id="modal-close" aria-label="Cerrar">
                <i class="ph ph-x"></i>
            </button>

            <div class="modal-header-tipo">
                <div class="modal-arbol-icon" id="modal-arbol-icon">
                    <i class="ph ph-tree" id="modal-icon-inner"></i>
                </div>
                <div>
                    <span class="modal-tipo-badge" id="modal-badge">Especial</span>
                    <h2 class="modal-titulo" id="modal-titulo">Título</h2>
                </div>
            </div>

            <div class="modal-meta">
                <span><i class="ph ph-calendar"></i> <span id="modal-fecha">Fecha</span></span>
                <span><i class="ph ph-map-pin"></i> <span id="modal-lugar">Lugar</span></span>
            </div>

            <p class="modal-historia" id="modal-historia">Historia...</p>

            <div style="margin-top:20px;text-align:right;">
                <button id="modal-btn-eliminar" onclick="eliminarRecuerdoActual()"
                    style="background:transparent;color:#c0392b;border:1.5px solid #f5c6c6;font-family:'Inter',sans-serif;font-size:0.78rem;padding:7px 14px;border-radius:8px;cursor:pointer;display:inline-flex;align-items:center;gap:5px;transition:all 0.2s;">
                    <i class="ph ph-trash"></i> Eliminar recuerdo
                </button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <i class="ph ph-check-circle"></i>
        Un nuevo recuerdo ha echado raíces.
    </div>

    <script src="js/data.js"></script>
    <script src="js/tour.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
</body>

</html>